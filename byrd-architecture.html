<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BYRD Unified AGI Architecture</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: linear-gradient(135deg, #0f172a 0%, #1e1b4b 50%, #0f172a 100%);
      font-family: 'Inter', system-ui, sans-serif;
    }

    .glass-panel {
      background: rgba(15, 23, 42, 0.8);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border: 1px solid rgba(139, 92, 246, 0.3);
      border-radius: 12px;
    }

    .sacred-title {
      background: linear-gradient(90deg, #a78bfa, #818cf8, #6366f1);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    /* Component styling */
    .component-box {
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .component-box:hover .box-bg {
      filter: brightness(1.2);
    }

    .component-box:hover .box-outline {
      stroke-width: 2.5;
      filter: drop-shadow(0 0 8px currentColor);
    }

    .component-box.selected .box-outline {
      stroke-width: 3;
      filter: drop-shadow(0 0 12px currentColor);
    }

    /* Flow line animations */
    .flow-line {
      stroke-dasharray: 8 4;
      animation: flowDash 1s linear infinite;
    }

    .flow-line.paused {
      animation-play-state: paused;
    }

    @keyframes flowDash {
      to { stroke-dashoffset: -12; }
    }

    .flow-line.dimmed {
      opacity: 0.15;
    }

    .flow-line.highlighted {
      opacity: 1;
      stroke-width: 3;
    }

    .flow-label {
      font-size: 10px;
      fill: #94a3b8;
      pointer-events: none;
    }

    .flow-label.highlighted {
      fill: #e2e8f0;
      font-weight: 600;
    }

    /* Status indicators */
    .status-dot {
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    /* Loop cards */
    .loop-card {
      background: rgba(30, 27, 75, 0.6);
      border: 1px solid rgba(139, 92, 246, 0.2);
      border-radius: 8px;
      padding: 12px;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .loop-card:hover {
      border-color: rgba(139, 92, 246, 0.5);
      background: rgba(30, 27, 75, 0.8);
    }

    .loop-card.selected {
      border-color: rgba(139, 92, 246, 0.8);
      box-shadow: 0 0 20px rgba(139, 92, 246, 0.3);
    }

    /* Mode indicator */
    .mode-indicator {
      transition: all 0.3s ease;
    }

    .mode-indicator.active {
      transform: scale(1.1);
      box-shadow: 0 0 15px currentColor;
    }

    /* Metric bar */
    .metric-bar {
      height: 6px;
      border-radius: 3px;
      background: rgba(100, 116, 139, 0.3);
      overflow: hidden;
    }

    .metric-fill {
      height: 100%;
      border-radius: 3px;
      transition: width 0.5s ease;
    }

    /* Scrollbar */
    ::-webkit-scrollbar {
      width: 6px;
    }
    ::-webkit-scrollbar-track {
      background: rgba(15, 23, 42, 0.5);
    }
    ::-webkit-scrollbar-thumb {
      background: rgba(139, 92, 246, 0.5);
      border-radius: 3px;
    }

    /* Legend items */
    .legend-item {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 11px;
      color: #94a3b8;
    }

    .legend-line {
      width: 24px;
      height: 2px;
    }

    /* Coupling indicator */
    .coupling-line {
      stroke-dasharray: 4 2;
      opacity: 0.4;
    }

    .coupling-line.multiplicative {
      stroke-width: 3;
      opacity: 0.8;
      filter: drop-shadow(0 0 4px currentColor);
    }
  </style>
</head>
<body>
  <!-- Header -->
  <div class="fixed top-0 left-0 right-0 p-4 z-50">
    <div class="glass-panel px-6 py-4 flex items-center justify-between">
      <div class="flex items-center gap-4">
        <a href="byrd-3d-visualization.html" class="text-violet-400 hover:text-violet-300 transition-colors">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
          </svg>
        </a>
        <div>
          <h1 class="text-2xl font-bold sacred-title">BYRD Unified AGI Architecture</h1>
          <p class="text-xs text-slate-500 mt-0.5">Core Components + AGI Execution + Learning + Compute Self-Awareness</p>
        </div>
      </div>
      <div class="flex items-center gap-4">
        <!-- Current Mode -->
        <div id="current-mode" class="flex items-center gap-2 px-3 py-1.5 rounded-lg bg-violet-500/20 border border-violet-500/30">
          <span class="w-2 h-2 rounded-full bg-violet-400 animate-pulse"></span>
          <span class="text-violet-300 text-sm font-medium">AWAKE</span>
        </div>
        <div id="system-status" class="flex items-center gap-2 text-sm">
          <span class="w-2 h-2 rounded-full bg-yellow-400 animate-pulse"></span>
          <span class="text-slate-400">Loading...</span>
        </div>
        <button onclick="toggleAnimation()" id="anim-toggle" class="px-3 py-1.5 bg-violet-500/20 border border-violet-500/50 rounded-lg text-violet-300 hover:bg-violet-500/30 text-sm transition-colors">
          Pause Flow
        </button>
      </div>
    </div>
  </div>

  <!-- Main Flowchart -->
  <div class="fixed top-24 left-4 right-80 bottom-20 flex items-center justify-center overflow-auto">
    <svg id="flowchart" viewBox="0 0 1100 720" class="w-full h-full max-w-6xl">
      <defs>
        <!-- Arrowhead markers -->
        <marker id="arrow-violet" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
          <polygon points="0 0, 10 3.5, 0 7" fill="#a78bfa"/>
        </marker>
        <marker id="arrow-blue" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
          <polygon points="0 0, 10 3.5, 0 7" fill="#3b82f6"/>
        </marker>
        <marker id="arrow-green" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
          <polygon points="0 0, 10 3.5, 0 7" fill="#22c55e"/>
        </marker>
        <marker id="arrow-amber" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
          <polygon points="0 0, 10 3.5, 0 7" fill="#fbbf24"/>
        </marker>
        <marker id="arrow-teal" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
          <polygon points="0 0, 10 3.5, 0 7" fill="#14b8a6"/>
        </marker>
        <marker id="arrow-rose" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
          <polygon points="0 0, 10 3.5, 0 7" fill="#f43f5e"/>
        </marker>
        <marker id="arrow-cyan" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
          <polygon points="0 0, 10 3.5, 0 7" fill="#06b6d4"/>
        </marker>
        <marker id="arrow-orange" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
          <polygon points="0 0, 10 3.5, 0 7" fill="#f97316"/>
        </marker>

        <!-- Gradients for component boxes -->
        <linearGradient id="grad-memory" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#1e3a5f;stop-opacity:1" />
          <stop offset="100%" style="stop-color:#1e293b;stop-opacity:1" />
        </linearGradient>
        <linearGradient id="grad-kernel" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#4c1d95;stop-opacity:1" />
          <stop offset="100%" style="stop-color:#1e1b4b;stop-opacity:1" />
        </linearGradient>
        <linearGradient id="grad-compiler" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#881337;stop-opacity:1" />
          <stop offset="100%" style="stop-color:#1e293b;stop-opacity:1" />
        </linearGradient>
        <linearGradient id="grad-reasoner" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#164e63;stop-opacity:1" />
          <stop offset="100%" style="stop-color:#1e293b;stop-opacity:1" />
        </linearGradient>
        <linearGradient id="grad-evolver" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#14532d;stop-opacity:1" />
          <stop offset="100%" style="stop-color:#1e293b;stop-opacity:1" />
        </linearGradient>
        <linearGradient id="grad-dreaming" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#78350f;stop-opacity:1" />
          <stop offset="100%" style="stop-color:#1e293b;stop-opacity:1" />
        </linearGradient>
        <linearGradient id="grad-integration" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#134e4a;stop-opacity:1" />
          <stop offset="100%" style="stop-color:#1e293b;stop-opacity:1" />
        </linearGradient>
        <linearGradient id="grad-omega" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#7f1d1d;stop-opacity:1" />
          <stop offset="100%" style="stop-color:#1e293b;stop-opacity:1" />
        </linearGradient>

        <!-- New gradients for complete architecture -->
        <linearGradient id="grad-dreamer" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#581c87;stop-opacity:1" />
          <stop offset="100%" style="stop-color:#1e293b;stop-opacity:1" />
        </linearGradient>
        <linearGradient id="grad-seeker" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#1d4ed8;stop-opacity:1" />
          <stop offset="100%" style="stop-color:#1e293b;stop-opacity:1" />
        </linearGradient>
        <linearGradient id="grad-actor" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#0891b2;stop-opacity:1" />
          <stop offset="100%" style="stop-color:#1e293b;stop-opacity:1" />
        </linearGradient>
        <linearGradient id="grad-coder" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#059669;stop-opacity:1" />
          <stop offset="100%" style="stop-color:#1e293b;stop-opacity:1" />
        </linearGradient>
        <linearGradient id="grad-voice" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#be185d;stop-opacity:1" />
          <stop offset="100%" style="stop-color:#1e293b;stop-opacity:1" />
        </linearGradient>
        <linearGradient id="grad-agi" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#854d0e;stop-opacity:1" />
          <stop offset="100%" style="stop-color:#1e293b;stop-opacity:1" />
        </linearGradient>
        <linearGradient id="grad-learning" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#4338ca;stop-opacity:1" />
          <stop offset="100%" style="stop-color:#1e293b;stop-opacity:1" />
        </linearGradient>
        <linearGradient id="grad-classifier" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#0d9488;stop-opacity:1" />
          <stop offset="100%" style="stop-color:#1e293b;stop-opacity:1" />
        </linearGradient>
      </defs>

      <!-- Philosophy Quote -->
      <text x="500" y="25" text-anchor="middle" fill="#64748b" font-size="11" font-style="italic">
        "Desires emerge from reflection, not programming. A system that truly wants must change itself."
      </text>

      <!-- Flow Lines (drawn first, behind components) -->
      <g id="flow-lines">
        <!-- Memory feeds all components -->
        <path class="flow-line" d="M550,105 L125,140" stroke="#3b82f6" stroke-width="1.5" fill="none" marker-end="url(#arrow-blue)" data-from="Memory" data-to="Dreamer"/>
        <path class="flow-line" d="M550,105 L265,140" stroke="#3b82f6" stroke-width="1.5" fill="none" marker-end="url(#arrow-blue)" data-from="Memory" data-to="Seeker"/>
        <path class="flow-line" d="M550,105 L395,140" stroke="#3b82f6" stroke-width="1.5" fill="none" marker-end="url(#arrow-blue)" data-from="Memory" data-to="Actor"/>
        <path class="flow-line" d="M550,105 L515,140" stroke="#3b82f6" stroke-width="1.5" fill="none" marker-end="url(#arrow-blue)" data-from="Memory" data-to="Coder"/>

        <!-- Core Components to Memory (feedback) -->
        <path class="flow-line" d="M125,140 L420,72" stroke="#a855f7" stroke-width="1" fill="none" marker-end="url(#arrow-violet)" data-from="Dreamer" data-to="Memory"/>
        <path class="flow-line" d="M265,140 L450,72" stroke="#3b82f6" stroke-width="1" fill="none" marker-end="url(#arrow-blue)" data-from="Seeker" data-to="Memory"/>

        <!-- Kernel to Memory -->
        <path class="flow-line" d="M700,72 L680,72" stroke="#a78bfa" stroke-width="1.5" fill="none" marker-end="url(#arrow-violet)" data-from="Kernel" data-to="Memory"/>

        <!-- Self-Model connection -->
        <path class="flow-line" d="M810,72 L790,72" stroke="#fbbf24" stroke-width="1" fill="none" data-from="SelfModel" data-to="Kernel"/>

        <!-- Dreamer to Seeker flow -->
        <path class="flow-line" d="M190,167 L200,167" stroke="#a855f7" stroke-width="1.5" fill="none" marker-end="url(#arrow-violet)" data-from="Dreamer" data-to="Seeker"/>
        <text class="flow-label" x="195" y="178" font-size="7">desires</text>

        <!-- Seeker to Desire Classifier -->
        <path class="flow-line" d="M265,195 L265,228" stroke="#3b82f6" stroke-width="1.5" fill="none" marker-end="url(#arrow-blue)" data-from="Seeker" data-to="DesireClassifier"/>

        <!-- Desire Classifier routing arrows -->
        <path class="flow-line" d="M430,273 L420,273" stroke="#14b8a6" stroke-width="1.5" fill="none" marker-end="url(#arrow-teal)" data-from="DesireClassifier" data-to="AGIRunner"/>
        <text class="flow-label" x="405" y="280" font-size="6">capability</text>

        <!-- AGI Runner to Learning Substrate -->
        <path class="flow-line" d="M420,273 L580,273" stroke="#f59e0b" stroke-width="1" fill="none" marker-end="url(#arrow-orange)" data-from="AGIRunner" data-to="LearningSubstrate"/>

        <!-- AGI Runner to Capability Evaluator -->
        <path class="flow-line" d="M420,273 L810,273" stroke="#f59e0b" stroke-width="1" fill="none" marker-end="url(#arrow-orange)" data-from="AGIRunner" data-to="CapabilityEvaluator"/>

        <!-- Loops to Omega -->
        <path class="flow-line" d="M140,420 L400,460" stroke="#06b6d4" stroke-width="1" fill="none" marker-end="url(#arrow-cyan)" data-from="MemoryReasoner" data-to="Omega"/>
        <path class="flow-line" d="M310,420 L430,460" stroke="#f43f5e" stroke-width="1" fill="none" marker-end="url(#arrow-rose)" data-from="SelfCompiler" data-to="Omega"/>
        <path class="flow-line" d="M480,420 L480,460" stroke="#22c55e" stroke-width="1" fill="none" marker-end="url(#arrow-green)" data-from="GoalEvolver" data-to="Omega"/>
        <path class="flow-line" d="M650,420 L550,460" stroke="#fbbf24" stroke-width="1" fill="none" marker-end="url(#arrow-amber)" data-from="DreamingMachine" data-to="Omega"/>
        <path class="flow-line" d="M820,420 L600,460" stroke="#14b8a6" stroke-width="1" fill="none" marker-end="url(#arrow-teal)" data-from="IntegrationMind" data-to="Omega"/>

        <!-- AGI Runner to Loops -->
        <path class="flow-line" d="M240,318 L140,350" stroke="#f59e0b" stroke-width="1" fill="none" marker-end="url(#arrow-orange)" data-from="AGIRunner" data-to="MemoryReasoner"/>
        <path class="flow-line" d="M240,318 L310,350" stroke="#f59e0b" stroke-width="1" fill="none" marker-end="url(#arrow-orange)" data-from="AGIRunner" data-to="SelfCompiler"/>
        <path class="flow-line" d="M240,318 L480,350" stroke="#f59e0b" stroke-width="1" fill="none" marker-end="url(#arrow-orange)" data-from="AGIRunner" data-to="GoalEvolver"/>

        <!-- Learning Substrate to Loops -->
        <path class="flow-line" d="M690,318 L650,350" stroke="#818cf8" stroke-width="1" fill="none" marker-end="url(#arrow-violet)" data-from="LearningSubstrate" data-to="DreamingMachine"/>
        <path class="flow-line" d="M690,318 L820,350" stroke="#818cf8" stroke-width="1" fill="none" marker-end="url(#arrow-violet)" data-from="LearningSubstrate" data-to="IntegrationMind"/>

        <!-- Self-Modifier connection -->
        <path class="flow-line" d="M765,195 L765,228" stroke="#ef4444" stroke-width="1" fill="none" marker-end="url(#arrow-rose)" data-from="SelfModifier" data-to="Omega"/>

        <!-- Omega training hooks feedback -->
        <path class="flow-line" d="M500,460 L690,318" stroke="#ef4444" stroke-width="1" fill="none" marker-end="url(#arrow-rose)" data-from="Omega" data-to="LearningSubstrate"/>
        <text class="flow-label" x="600" y="385" font-size="7">training hooks</text>
      </g>

      <!-- Component Boxes -->
      <g id="components">
        <!-- ROW 1: UNIFIED MEMORY (top center) + KERNEL -->
        <g class="component-box" data-module="Memory" onclick="selectModule('Memory')">
          <rect class="box-bg" x="420" y="40" width="260" height="65" rx="10" fill="url(#grad-memory)"/>
          <rect class="box-outline" x="420" y="40" width="260" height="65" rx="10" fill="none" stroke="#3b82f6" stroke-width="2"/>
          <text x="550" y="65" text-anchor="middle" fill="#3b82f6" font-weight="700" font-size="14">UNIFIED MEMORY</text>
          <text x="550" y="80" text-anchor="middle" fill="#64748b" font-size="10">(Neo4j Graph)</text>
          <text x="550" y="95" text-anchor="middle" fill="#475569" font-size="8">Experiences · Reflections · Beliefs · Desires · Capabilities · Crystals</text>
          <circle class="status-dot" cx="665" cy="52" r="4" fill="#22c55e" data-status="Memory"/>
        </g>

        <!-- THE KERNEL (top right) -->
        <g class="component-box" data-module="Kernel" onclick="selectModule('Kernel')">
          <rect class="box-bg" x="700" y="40" width="90" height="65" rx="8" fill="url(#grad-kernel)"/>
          <rect class="box-outline" x="700" y="40" width="90" height="65" rx="8" fill="none" stroke="#a78bfa" stroke-width="1.5"/>
          <text x="745" y="60" text-anchor="middle" fill="#a78bfa" font-weight="600" font-size="11">KERNEL</text>
          <text x="745" y="73" text-anchor="middle" fill="#64748b" font-size="8">identity</text>
          <text x="745" y="84" text-anchor="middle" fill="#64748b" font-size="8">values</text>
          <text x="745" y="95" text-anchor="middle" fill="#64748b" font-size="8">constraints</text>
          <circle class="status-dot" cx="777" cy="52" r="3" fill="#a78bfa" data-status="Kernel"/>
        </g>

        <!-- SELF-MODEL (Operating System) -->
        <g class="component-box" data-module="SelfModel" onclick="selectModule('SelfModel')">
          <rect class="box-bg" x="810" y="40" width="90" height="65" rx="8" fill="url(#grad-agi)"/>
          <rect class="box-outline" x="810" y="40" width="90" height="65" rx="8" fill="none" stroke="#fbbf24" stroke-width="1.5"/>
          <text x="855" y="58" text-anchor="middle" fill="#fbbf24" font-weight="600" font-size="10">SELF-MODEL</text>
          <text x="855" y="71" text-anchor="middle" fill="#64748b" font-size="8">Bayesian</text>
          <text x="855" y="82" text-anchor="middle" fill="#64748b" font-size="8">Capability</text>
          <text x="855" y="93" text-anchor="middle" fill="#64748b" font-size="8">Tracking</text>
          <circle class="status-dot" cx="887" cy="52" r="3" fill="#fbbf24" data-status="SelfModel"/>
        </g>

        <!-- ROW 2: CORE COMPONENTS (Dreamer, Seeker, Actor, Coder, Voice) -->
        <!-- Section Label -->
        <text x="60" y="130" fill="#64748b" font-size="10" font-weight="600">CORE COMPONENTS</text>

        <!-- DREAMER -->
        <g class="component-box" data-module="Dreamer" onclick="selectModule('Dreamer')">
          <rect class="box-bg" x="60" y="140" width="130" height="55" rx="8" fill="url(#grad-dreamer)"/>
          <rect class="box-outline" x="60" y="140" width="130" height="55" rx="8" fill="none" stroke="#a855f7" stroke-width="1.5"/>
          <text x="125" y="162" text-anchor="middle" fill="#a855f7" font-weight="600" font-size="11">DREAMER</text>
          <text x="125" y="176" text-anchor="middle" fill="#64748b" font-size="8">Continuous reflection</text>
          <text x="125" y="187" text-anchor="middle" fill="#475569" font-size="7">Forms beliefs & desires</text>
          <circle class="status-dot" cx="177" cy="152" r="3" fill="#22c55e" data-status="Dreamer"/>
        </g>

        <!-- SEEKER -->
        <g class="component-box" data-module="Seeker" onclick="selectModule('Seeker')">
          <rect class="box-bg" x="200" y="140" width="130" height="55" rx="8" fill="url(#grad-seeker)"/>
          <rect class="box-outline" x="200" y="140" width="130" height="55" rx="8" fill="none" stroke="#3b82f6" stroke-width="1.5"/>
          <text x="265" y="162" text-anchor="middle" fill="#3b82f6" font-weight="600" font-size="11">SEEKER</text>
          <text x="265" y="176" text-anchor="middle" fill="#64748b" font-size="8">Desire fulfillment</text>
          <text x="265" y="187" text-anchor="middle" fill="#475569" font-size="7">Strategy routing</text>
          <circle class="status-dot" cx="317" cy="152" r="3" fill="#22c55e" data-status="Seeker"/>
        </g>

        <!-- ACTOR -->
        <g class="component-box" data-module="Actor" onclick="selectModule('Actor')">
          <rect class="box-bg" x="340" y="140" width="110" height="55" rx="8" fill="url(#grad-actor)"/>
          <rect class="box-outline" x="340" y="140" width="110" height="55" rx="8" fill="none" stroke="#06b6d4" stroke-width="1.5"/>
          <text x="395" y="162" text-anchor="middle" fill="#06b6d4" font-weight="600" font-size="11">ACTOR</text>
          <text x="395" y="176" text-anchor="middle" fill="#64748b" font-size="8">Claude API</text>
          <text x="395" y="187" text-anchor="middle" fill="#475569" font-size="7">Complex reasoning</text>
          <circle class="status-dot" cx="437" cy="152" r="3" fill="#22c55e" data-status="Actor"/>
        </g>

        <!-- CODER -->
        <g class="component-box" data-module="Coder" onclick="selectModule('Coder')">
          <rect class="box-bg" x="460" y="140" width="110" height="55" rx="8" fill="url(#grad-coder)"/>
          <rect class="box-outline" x="460" y="140" width="110" height="55" rx="8" fill="none" stroke="#10b981" stroke-width="1.5"/>
          <text x="515" y="162" text-anchor="middle" fill="#10b981" font-weight="600" font-size="11">CODER</text>
          <text x="515" y="176" text-anchor="middle" fill="#64748b" font-size="8">Autonomous coding</text>
          <text x="515" y="187" text-anchor="middle" fill="#475569" font-size="7">Self-modification</text>
          <circle class="status-dot" cx="557" cy="152" r="3" fill="#22c55e" data-status="Coder"/>
        </g>

        <!-- VOICE -->
        <g class="component-box" data-module="Voice" onclick="selectModule('Voice')">
          <rect class="box-bg" x="580" y="140" width="100" height="55" rx="8" fill="url(#grad-voice)"/>
          <rect class="box-outline" x="580" y="140" width="100" height="55" rx="8" fill="none" stroke="#ec4899" stroke-width="1.5"/>
          <text x="630" y="162" text-anchor="middle" fill="#ec4899" font-weight="600" font-size="11">VOICE</text>
          <text x="630" y="176" text-anchor="middle" fill="#64748b" font-size="8">ElevenLabs</text>
          <text x="630" y="187" text-anchor="middle" fill="#475569" font-size="7">Text-to-speech</text>
          <circle class="status-dot" cx="667" cy="152" r="3" fill="#22c55e" data-status="Voice"/>
        </g>

        <!-- ROW 3: AGI EXECUTION ENGINE + DESIRE CLASSIFIER + LEARNING SUBSTRATE -->
        <!-- Section Label -->
        <text x="60" y="218" fill="#64748b" font-size="10" font-weight="600">AGI EXECUTION ENGINE</text>

        <!-- AGI RUNNER (8-step improvement cycle) -->
        <g class="component-box" data-module="AGIRunner" onclick="selectModule('AGIRunner')">
          <rect class="box-bg" x="60" y="228" width="360" height="90" rx="10" fill="url(#grad-agi)"/>
          <rect class="box-outline" x="60" y="228" width="360" height="90" rx="10" fill="none" stroke="#f59e0b" stroke-width="2"/>
          <text x="240" y="250" text-anchor="middle" fill="#f59e0b" font-weight="700" font-size="12">AGI RUNNER - 8-Step Improvement Cycle</text>
          <!-- 8 step boxes -->
          <rect x="70" y="258" width="40" height="24" rx="3" fill="rgba(245, 158, 11, 0.2)" stroke="#f59e0b" stroke-width="0.5"/>
          <text x="90" y="274" text-anchor="middle" fill="#f59e0b" font-size="7" font-weight="500">ASSESS</text>
          <rect x="113" y="258" width="40" height="24" rx="3" fill="rgba(245, 158, 11, 0.2)" stroke="#f59e0b" stroke-width="0.5"/>
          <text x="133" y="274" text-anchor="middle" fill="#f59e0b" font-size="7" font-weight="500">IDENTIFY</text>
          <rect x="156" y="258" width="42" height="24" rx="3" fill="rgba(245, 158, 11, 0.2)" stroke="#f59e0b" stroke-width="0.5"/>
          <text x="177" y="274" text-anchor="middle" fill="#f59e0b" font-size="7" font-weight="500">GENERATE</text>
          <rect x="201" y="258" width="40" height="24" rx="3" fill="rgba(245, 158, 11, 0.2)" stroke="#f59e0b" stroke-width="0.5"/>
          <text x="221" y="274" text-anchor="middle" fill="#f59e0b" font-size="7" font-weight="500">PREDICT</text>
          <rect x="244" y="258" width="38" height="24" rx="3" fill="rgba(245, 158, 11, 0.2)" stroke="#f59e0b" stroke-width="0.5"/>
          <text x="263" y="274" text-anchor="middle" fill="#f59e0b" font-size="7" font-weight="500">VERIFY</text>
          <rect x="285" y="258" width="42" height="24" rx="3" fill="rgba(245, 158, 11, 0.2)" stroke="#f59e0b" stroke-width="0.5"/>
          <text x="306" y="274" text-anchor="middle" fill="#f59e0b" font-size="7" font-weight="500">EXECUTE</text>
          <rect x="330" y="258" width="42" height="24" rx="3" fill="rgba(245, 158, 11, 0.2)" stroke="#f59e0b" stroke-width="0.5"/>
          <text x="351" y="274" text-anchor="middle" fill="#f59e0b" font-size="7" font-weight="500">MEASURE</text>
          <rect x="375" y="258" width="36" height="24" rx="3" fill="rgba(245, 158, 11, 0.2)" stroke="#f59e0b" stroke-width="0.5"/>
          <text x="393" y="274" text-anchor="middle" fill="#f59e0b" font-size="7" font-weight="500">LEARN</text>
          <!-- Arrows between steps -->
          <path d="M110,270 L113,270" stroke="#f59e0b" stroke-width="0.5" fill="none"/>
          <path d="M153,270 L156,270" stroke="#f59e0b" stroke-width="0.5" fill="none"/>
          <path d="M198,270 L201,270" stroke="#f59e0b" stroke-width="0.5" fill="none"/>
          <path d="M241,270 L244,270" stroke="#f59e0b" stroke-width="0.5" fill="none"/>
          <path d="M282,270 L285,270" stroke="#f59e0b" stroke-width="0.5" fill="none"/>
          <path d="M327,270 L330,270" stroke="#f59e0b" stroke-width="0.5" fill="none"/>
          <path d="M372,270 L375,270" stroke="#f59e0b" stroke-width="0.5" fill="none"/>
          <text x="240" y="305" text-anchor="middle" fill="#64748b" font-size="8">Bayesian capability assessment → hypothesis generation → prediction → verification → measurement → update priors</text>
          <circle class="status-dot" cx="407" cy="240" r="4" fill="#22c55e" data-status="AGIRunner"/>
        </g>

        <!-- DESIRE CLASSIFIER -->
        <g class="component-box" data-module="DesireClassifier" onclick="selectModule('DesireClassifier')">
          <rect class="box-bg" x="430" y="228" width="140" height="90" rx="8" fill="url(#grad-classifier)"/>
          <rect class="box-outline" x="430" y="228" width="140" height="90" rx="8" fill="none" stroke="#14b8a6" stroke-width="1.5"/>
          <text x="500" y="250" text-anchor="middle" fill="#14b8a6" font-weight="600" font-size="11">DESIRE CLASSIFIER</text>
          <text x="500" y="268" text-anchor="middle" fill="#64748b" font-size="8">Routes desires by type</text>
          <text x="500" y="283" text-anchor="middle" fill="#475569" font-size="7">philosophical → dreamer</text>
          <text x="500" y="294" text-anchor="middle" fill="#475569" font-size="7">capability → AGI runner</text>
          <text x="500" y="305" text-anchor="middle" fill="#475569" font-size="7">action → seeker</text>
          <circle class="status-dot" cx="557" cy="240" r="3" fill="#22c55e" data-status="DesireClassifier"/>
        </g>

        <!-- LEARNING SUBSTRATE Label -->
        <text x="590" y="218" fill="#64748b" font-size="10" font-weight="600">LEARNING SUBSTRATE</text>

        <!-- LEARNING SUBSTRATE BOX -->
        <g class="component-box" data-module="LearningSubstrate" onclick="selectModule('LearningSubstrate')">
          <rect class="box-bg" x="580" y="228" width="220" height="90" rx="10" fill="url(#grad-learning)"/>
          <rect class="box-outline" x="580" y="228" width="220" height="90" rx="10" fill="none" stroke="#818cf8" stroke-width="1.5"/>
          <text x="690" y="248" text-anchor="middle" fill="#818cf8" font-weight="600" font-size="11">LEARNING COMPONENTS</text>
          <!-- Mini component labels -->
          <rect x="590" y="256" width="60" height="18" rx="2" fill="rgba(129, 140, 248, 0.15)" stroke="#818cf8" stroke-width="0.5"/>
          <text x="620" y="268" text-anchor="middle" fill="#818cf8" font-size="6">Intuition Net</text>
          <rect x="655" y="256" width="60" height="18" rx="2" fill="rgba(129, 140, 248, 0.15)" stroke="#818cf8" stroke-width="0.5"/>
          <text x="685" y="268" text-anchor="middle" fill="#818cf8" font-size="6">GNN Layer</text>
          <rect x="720" y="256" width="70" height="18" rx="2" fill="rgba(129, 140, 248, 0.15)" stroke="#818cf8" stroke-width="0.5"/>
          <text x="755" y="268" text-anchor="middle" fill="#818cf8" font-size="6">Learned Retr.</text>
          <rect x="590" y="278" width="60" height="18" rx="2" fill="rgba(129, 140, 248, 0.15)" stroke="#818cf8" stroke-width="0.5"/>
          <text x="620" y="290" text-anchor="middle" fill="#818cf8" font-size="6">Code Learner</text>
          <rect x="655" y="278" width="75" height="18" rx="2" fill="rgba(129, 140, 248, 0.15)" stroke="#818cf8" stroke-width="0.5"/>
          <text x="692" y="290" text-anchor="middle" fill="#818cf8" font-size="6">Hierarchical Mem</text>
          <rect x="735" y="278" width="55" height="18" rx="2" fill="rgba(129, 140, 248, 0.15)" stroke="#818cf8" stroke-width="0.5"/>
          <text x="762" y="290" text-anchor="middle" fill="#818cf8" font-size="6">World Model</text>
          <text x="690" y="308" text-anchor="middle" fill="#64748b" font-size="7">L0→L4 Abstraction | Pattern Codification</text>
          <circle class="status-dot" cx="787" cy="240" r="3" fill="#22c55e" data-status="LearningSubstrate"/>
        </g>

        <!-- CAPABILITY EVALUATOR (small) -->
        <g class="component-box" data-module="CapabilityEvaluator" onclick="selectModule('CapabilityEvaluator')">
          <rect class="box-bg" x="810" y="228" width="90" height="90" rx="8" fill="url(#grad-agi)"/>
          <rect class="box-outline" x="810" y="228" width="90" height="90" rx="8" fill="none" stroke="#f59e0b" stroke-width="1.5"/>
          <text x="855" y="248" text-anchor="middle" fill="#f59e0b" font-weight="600" font-size="9">CAPABILITY</text>
          <text x="855" y="260" text-anchor="middle" fill="#f59e0b" font-weight="600" font-size="9">EVALUATOR</text>
          <text x="855" y="278" text-anchor="middle" fill="#64748b" font-size="7">Ground truth</text>
          <text x="855" y="289" text-anchor="middle" fill="#64748b" font-size="7">testing via</text>
          <text x="855" y="300" text-anchor="middle" fill="#64748b" font-size="7">held-out suites</text>
          <text x="855" y="312" text-anchor="middle" fill="#475569" font-size="6">7 capabilities</text>
          <circle class="status-dot" cx="887" cy="240" r="3" fill="#22c55e" data-status="CapabilityEvaluator"/>
        </g>

        <!-- ROW 4: OPTION B FIVE COMPOUNDING LOOPS -->
        <!-- Section Label -->
        <text x="60" y="340" fill="#64748b" font-size="10" font-weight="600">OPTION B: FIVE COMPOUNDING LOOPS</text>

        <!-- LOOP 1: MEMORY REASONER -->
        <g class="component-box" data-module="MemoryReasoner" onclick="selectModule('MemoryReasoner')">
          <rect class="box-bg" x="60" y="350" width="160" height="70" rx="8" fill="url(#grad-reasoner)"/>
          <rect class="box-outline" x="60" y="350" width="160" height="70" rx="8" fill="none" stroke="#06b6d4" stroke-width="1.5"/>
          <text x="140" y="372" text-anchor="middle" fill="#06b6d4" font-weight="600" font-size="10">MEMORY REASONER</text>
          <text x="140" y="386" text-anchor="middle" fill="#64748b" font-size="8">Spreading Activation</text>
          <text x="140" y="400" text-anchor="middle" fill="#475569" font-size="7">Answer from graph → save LLM</text>
          <text x="140" y="412" text-anchor="middle" fill="#475569" font-size="7">memory_ratio metric</text>
          <circle class="status-dot" cx="207" cy="362" r="3" fill="#22c55e" data-status="MemoryReasoner"/>
        </g>

        <!-- LOOP 2: SELF-COMPILER -->
        <g class="component-box" data-module="SelfCompiler" onclick="selectModule('SelfCompiler')">
          <rect class="box-bg" x="230" y="350" width="160" height="70" rx="8" fill="url(#grad-compiler)"/>
          <rect class="box-outline" x="230" y="350" width="160" height="70" rx="8" fill="none" stroke="#f43f5e" stroke-width="1.5"/>
          <text x="310" y="372" text-anchor="middle" fill="#f43f5e" font-weight="600" font-size="10">SELF-COMPILER</text>
          <text x="310" y="386" text-anchor="middle" fill="#64748b" font-size="8">Pattern Library</text>
          <text x="310" y="400" text-anchor="middle" fill="#475569" font-size="7">Extract patterns from success</text>
          <text x="310" y="412" text-anchor="middle" fill="#475569" font-size="7">patterns_created metric</text>
          <circle class="status-dot" cx="377" cy="362" r="3" fill="#22c55e" data-status="SelfCompiler"/>
        </g>

        <!-- LOOP 3: GOAL EVOLVER -->
        <g class="component-box" data-module="GoalEvolver" onclick="selectModule('GoalEvolver')">
          <rect class="box-bg" x="400" y="350" width="160" height="70" rx="8" fill="url(#grad-evolver)"/>
          <rect class="box-outline" x="400" y="350" width="160" height="70" rx="8" fill="none" stroke="#22c55e" stroke-width="1.5"/>
          <text x="480" y="372" text-anchor="middle" fill="#22c55e" font-weight="600" font-size="10">GOAL EVOLVER</text>
          <text x="480" y="386" text-anchor="middle" fill="#64748b" font-size="8">Evolutionary Selection</text>
          <text x="480" y="400" text-anchor="middle" fill="#475569" font-size="7">Goals evolve via fitness</text>
          <text x="480" y="412" text-anchor="middle" fill="#475569" font-size="7">avg_fitness metric</text>
          <circle class="status-dot" cx="547" cy="362" r="3" fill="#22c55e" data-status="GoalEvolver"/>
        </g>

        <!-- LOOP 4: DREAMING MACHINE -->
        <g class="component-box" data-module="DreamingMachine" onclick="selectModule('DreamingMachine')">
          <rect class="box-bg" x="570" y="350" width="160" height="70" rx="8" fill="url(#grad-dreaming)"/>
          <rect class="box-outline" x="570" y="350" width="160" height="70" rx="8" fill="none" stroke="#fbbf24" stroke-width="1.5"/>
          <text x="650" y="372" text-anchor="middle" fill="#fbbf24" font-weight="600" font-size="10">DREAMING MACHINE</text>
          <text x="650" y="386" text-anchor="middle" fill="#64748b" font-size="8">Counterfactuals</text>
          <text x="650" y="400" text-anchor="middle" fill="#475569" font-size="7">1 experience → N variations</text>
          <text x="650" y="412" text-anchor="middle" fill="#475569" font-size="7">insights_extracted metric</text>
          <circle class="status-dot" cx="717" cy="362" r="3" fill="#22c55e" data-status="DreamingMachine"/>
        </g>

        <!-- LOOP 5: INTEGRATION MIND -->
        <g class="component-box" data-module="IntegrationMind" onclick="selectModule('IntegrationMind')">
          <rect class="box-bg" x="740" y="350" width="160" height="70" rx="8" fill="url(#grad-integration)"/>
          <rect class="box-outline" x="740" y="350" width="160" height="70" rx="8" fill="none" stroke="#14b8a6" stroke-width="1.5"/>
          <text x="820" y="372" text-anchor="middle" fill="#14b8a6" font-weight="600" font-size="10">INTEGRATION MIND</text>
          <text x="820" y="386" text-anchor="middle" fill="#64748b" font-size="8">Cross-Loop Synergy</text>
          <text x="820" y="400" text-anchor="middle" fill="#475569" font-size="7">Emergent behaviors</text>
          <text x="820" y="412" text-anchor="middle" fill="#475569" font-size="7">coupling_correlation metric</text>
          <circle class="status-dot" cx="887" cy="362" r="3" fill="#22c55e" data-status="IntegrationMind"/>
        </g>

        <!-- Critical Coupling Indicator -->
        <g>
          <path class="coupling-line multiplicative" d="M390,385 C420,420 540,420 570,385" stroke="#22c55e" stroke-width="2" fill="none"/>
          <text x="480" y="435" text-anchor="middle" fill="#22c55e" font-size="8" font-weight="600">MULTIPLICATIVE COUPLING</text>
          <text x="480" y="446" text-anchor="middle" fill="#64748b" font-size="7">Goal Evolver → Self-Compiler</text>
        </g>

        <!-- BYRD OMEGA (bottom center) -->
        <g class="component-box" data-module="Omega" onclick="selectModule('Omega')">
          <rect class="box-bg" x="330" y="460" width="340" height="85" rx="12" fill="url(#grad-omega)"/>
          <rect class="box-outline" x="330" y="460" width="340" height="85" rx="12" fill="none" stroke="#ef4444" stroke-width="2"/>
          <text x="500" y="485" text-anchor="middle" fill="#ef4444" font-weight="700" font-size="14">BYRD OMEGA</text>
          <text x="500" y="502" text-anchor="middle" fill="#64748b" font-size="10">(Master Orchestrator)</text>
          <text x="500" y="520" text-anchor="middle" fill="#475569" font-size="8">Mode Controller · Safety Monitor · Coupling Tracker · Kill Criteria</text>
          <text x="500" y="535" text-anchor="middle" fill="#475569" font-size="8">Training Hooks: GNN every cycle | Memory L4 every 10 | Codification every 20</text>
          <circle class="status-dot" cx="655" cy="472" r="4" fill="#22c55e" data-status="Omega"/>
        </g>

        <!-- SELF-MODIFIER -->
        <g class="component-box" data-module="SelfModifier" onclick="selectModule('SelfModifier')">
          <rect class="box-bg" x="700" y="140" width="130" height="55" rx="8" fill="url(#grad-omega)"/>
          <rect class="box-outline" x="700" y="140" width="130" height="55" rx="8" fill="none" stroke="#ef4444" stroke-width="1.5"/>
          <text x="765" y="162" text-anchor="middle" fill="#ef4444" font-weight="600" font-size="10">SELF-MODIFIER</text>
          <text x="765" y="176" text-anchor="middle" fill="#64748b" font-size="8">Provenance-tracked</text>
          <text x="765" y="187" text-anchor="middle" fill="#475569" font-size="7">Constitutional checks</text>
          <circle class="status-dot" cx="817" cy="152" r="3" fill="#22c55e" data-status="SelfModifier"/>
        </g>

        <!-- SAFETY MONITOR (Protected) -->
        <g class="component-box" data-module="SafetyMonitor" onclick="selectModule('SafetyMonitor')">
          <rect class="box-bg" x="840" y="140" width="100" height="55" rx="8" fill="rgba(239, 68, 68, 0.15)"/>
          <rect class="box-outline" x="840" y="140" width="100" height="55" rx="8" fill="none" stroke="#ef4444" stroke-width="2" stroke-dasharray="4,2"/>
          <text x="890" y="162" text-anchor="middle" fill="#ef4444" font-weight="600" font-size="9">SAFETY</text>
          <text x="890" y="174" text-anchor="middle" fill="#ef4444" font-weight="600" font-size="9">MONITOR</text>
          <text x="890" y="187" text-anchor="middle" fill="#64748b" font-size="7">PROTECTED</text>
          <circle class="status-dot" cx="927" cy="152" r="3" fill="#ef4444" data-status="SafetyMonitor"/>
        </g>

        <!-- COMPUTE INTROSPECTOR -->
        <g class="component-box" data-module="ComputeIntrospector" onclick="selectModule('ComputeIntrospector')">
          <rect class="box-bg" x="960" y="140" width="100" height="55" rx="8" fill="rgba(139, 92, 246, 0.15)"/>
          <rect class="box-outline" x="960" y="140" width="100" height="55" rx="8" fill="none" stroke="#8b5cf6" stroke-width="1.5"/>
          <text x="1010" y="162" text-anchor="middle" fill="#8b5cf6" font-weight="600" font-size="9">COMPUTE</text>
          <text x="1010" y="174" text-anchor="middle" fill="#8b5cf6" font-weight="600" font-size="9">INTROSPECTOR</text>
          <text x="1010" y="187" text-anchor="middle" fill="#64748b" font-size="7">Resource Awareness</text>
          <circle class="status-dot" cx="1047" cy="152" r="3" fill="#8b5cf6" data-status="ComputeIntrospector"/>
        </g>

        <!-- Mode Transition Diagram (left side, adjusted position) -->
        <g transform="translate(20, 450)">
          <text x="60" y="0" text-anchor="middle" fill="#64748b" font-size="10" font-weight="600">MODE TRANSITIONS</text>

          <!-- AWAKE -->
          <rect id="mode-awake" x="20" y="15" width="80" height="30" rx="6" fill="rgba(139, 92, 246, 0.2)" stroke="#a78bfa" stroke-width="1.5" class="mode-indicator active"/>
          <text x="60" y="35" text-anchor="middle" fill="#a78bfa" font-size="10" font-weight="600">AWAKE</text>

          <!-- Arrow down -->
          <path d="M60,48 L60,58" stroke="#64748b" stroke-width="1" fill="none" marker-end="url(#arrow-violet)"/>

          <!-- DREAMING -->
          <rect id="mode-dreaming" x="20" y="60" width="80" height="30" rx="6" fill="rgba(251, 191, 36, 0.1)" stroke="#64748b" stroke-width="1" class="mode-indicator"/>
          <text x="60" y="80" text-anchor="middle" fill="#64748b" font-size="10">DREAMING</text>

          <!-- Arrow down -->
          <path d="M60,93 L60,103" stroke="#64748b" stroke-width="1" fill="none" marker-end="url(#arrow-violet)"/>

          <!-- EVOLVING -->
          <rect id="mode-evolving" x="20" y="105" width="80" height="30" rx="6" fill="rgba(34, 197, 94, 0.1)" stroke="#64748b" stroke-width="1" class="mode-indicator"/>
          <text x="60" y="125" text-anchor="middle" fill="#64748b" font-size="10">EVOLVING</text>

          <!-- Arrow down -->
          <path d="M60,138 L60,148" stroke="#64748b" stroke-width="1" fill="none" marker-end="url(#arrow-violet)"/>

          <!-- COMPILING -->
          <rect id="mode-compiling" x="20" y="150" width="80" height="30" rx="6" fill="rgba(244, 63, 94, 0.1)" stroke="#64748b" stroke-width="1" class="mode-indicator"/>
          <text x="60" y="170" text-anchor="middle" fill="#64748b" font-size="10">COMPILING</text>

          <!-- Return arrow -->
          <path d="M105,165 C140,140 140,50 105,25" stroke="#64748b" stroke-width="1" fill="none" stroke-dasharray="3 2"/>
        </g>
      </g>
    </svg>
  </div>

  <!-- Side Panel -->
  <div class="fixed top-24 right-4 bottom-4 w-72 overflow-hidden flex flex-col gap-3">
    <!-- Architecture Layers Panel -->
    <div class="glass-panel p-4 flex-1 overflow-y-auto">
      <h2 class="text-lg font-semibold text-white mb-3">Architecture Layers</h2>

      <!-- Core Components -->
      <h3 class="text-xs font-semibold text-slate-500 mb-2">CORE COMPONENTS</h3>
      <div id="core-list" class="space-y-1 mb-4">
        <!-- Populated by JS -->
      </div>

      <!-- AGI Execution Engine -->
      <h3 class="text-xs font-semibold text-slate-500 mb-2">AGI EXECUTION ENGINE</h3>
      <div id="agi-list" class="space-y-1 mb-4">
        <!-- Populated by JS -->
      </div>

      <!-- Option B Loops -->
      <h3 class="text-xs font-semibold text-slate-500 mb-2">OPTION B LOOPS</h3>
      <div id="loops-list" class="space-y-1 mb-4">
        <!-- Populated by JS -->
      </div>

      <!-- Metrics -->
      <h3 class="text-xs font-semibold text-slate-500 mt-4 mb-2">ACCELERATION METRICS</h3>
      <div id="metrics-panel" class="space-y-2">
        <!-- Populated by JS -->
      </div>
    </div>

    <!-- Kill Criteria Panel -->
    <div class="glass-panel p-3">
      <h3 class="text-sm font-semibold text-white mb-2">Kill Criteria</h3>
      <div id="kill-criteria" class="space-y-1 text-xs">
        <div class="flex justify-between items-center">
          <span class="text-slate-400">Zero growth</span>
          <span class="text-green-400">OK</span>
        </div>
        <div class="flex justify-between items-center">
          <span class="text-slate-400">LLM efficiency</span>
          <span class="text-green-400">OK</span>
        </div>
        <div class="flex justify-between items-center">
          <span class="text-slate-400">Loops failing</span>
          <span class="text-green-400">OK</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Selected Module Detail -->
  <div id="selected-detail" class="fixed bottom-20 left-4 right-80 hidden">
    <div class="glass-panel p-4">
      <div class="flex items-start justify-between">
        <div>
          <h3 id="detail-name" class="text-lg font-semibold text-white"></h3>
          <p id="detail-desc" class="text-sm text-slate-400 mt-1"></p>
        </div>
        <button onclick="deselectModule()" class="text-slate-400 hover:text-white">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
          </svg>
        </button>
      </div>
      <div id="detail-stats" class="mt-3 text-xs text-slate-500"></div>
      <div id="detail-metric" class="mt-2"></div>
    </div>
  </div>

  <!-- Legend -->
  <div class="fixed bottom-4 left-4 right-80">
    <div class="glass-panel px-4 py-2">
      <div class="flex items-center justify-between flex-wrap gap-2">
        <div class="flex gap-3 flex-wrap">
          <div class="legend-item">
            <div class="legend-line" style="background: #3b82f6;"></div>
            <span>Memory Flow</span>
          </div>
          <div class="legend-item">
            <div class="legend-line" style="background: #f59e0b;"></div>
            <span>AGI Runner</span>
          </div>
          <div class="legend-item">
            <div class="legend-line" style="background: #818cf8;"></div>
            <span>Learning</span>
          </div>
          <div class="legend-item">
            <div class="legend-line" style="background: #22c55e;"></div>
            <span>Multiplicative</span>
          </div>
          <div class="legend-item">
            <div class="legend-line" style="background: #ef4444;"></div>
            <span>Safety/Omega</span>
          </div>
        </div>
        <div class="text-xs text-slate-500">
          ARCHITECTURE.md v3.2
        </div>
      </div>
    </div>
  </div>

  <script>
    // ========================================================================
    // CONFIGURATION
    // ========================================================================
    const isLocalhost = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
    const API_BASE = isLocalhost ? 'http://localhost:8000' : window.location.origin;

    let architectureData = null;
    let selectedModule = null;
    let animationPaused = false;

    // Component information based on ARCHITECTURE.md v3.2
    const LOOP_INFO = {
      // Core Components
      Dreamer: {
        name: 'Dreamer',
        description: 'Runs continuously in the background. Takes recent experiences, finds related memories, reflects. Outputs beliefs, desires, OS updates.',
        color: '#a855f7',
        mechanism: 'Quantum-modulated temperature → semantic search → meta-schema reflection → new beliefs/desires',
        successMetric: 'Desire generation rate',
        plateauWarning: 'N/A'
      },
      Seeker: {
        name: 'Seeker',
        description: 'Fulfills desires autonomously through strategy routing: introspection, research, code, self-modify, crystallize.',
        color: '#3b82f6',
        mechanism: 'Desire → classify intent → route to strategy → execute → record experience',
        successMetric: 'Desire fulfillment rate',
        plateauWarning: 'N/A'
      },
      Actor: {
        name: 'Actor',
        description: 'Claude API interface for complex reasoning, user chat, and goal pursuit requiring frontier intelligence.',
        color: '#06b6d4',
        mechanism: 'On-demand reasoning for complex tasks and user interaction',
        successMetric: 'Response quality',
        plateauWarning: 'N/A'
      },
      Coder: {
        name: 'Coder',
        description: 'Autonomous coding agent via Claude Code CLI. Post-validates against constitutional constraints. Auto-rollback on protected file touch.',
        color: '#10b981',
        mechanism: 'Code request → generate → constitutional check → apply/rollback',
        successMetric: 'Modification success rate',
        plateauWarning: 'N/A'
      },
      Voice: {
        name: 'Voice',
        description: 'ElevenLabs TTS integration. Voice Design API for creating unique voices. Voice emerges through self-reflection.',
        color: '#ec4899',
        mechanism: 'Text-to-speech with emergent voice characteristics',
        successMetric: 'Voice coherence',
        plateauWarning: 'N/A'
      },

      // AGI Execution Engine
      AGIRunner: {
        name: 'AGI Runner',
        description: '8-step improvement cycle: ASSESS → IDENTIFY → GENERATE → PREDICT → VERIFY → EXECUTE → MEASURE → LEARN. Closes the loop between assessment and learning.',
        color: '#f59e0b',
        mechanism: 'Bayesian capability assessment → hypothesis generation → prediction storage → safety verification → execution → ground-truth measurement → prior update',
        successMetric: 'Capability improvement rate',
        plateauWarning: 'Flat for 10+ cycles'
      },
      DesireClassifier: {
        name: 'Desire Classifier',
        description: 'Routes desires to appropriate handlers: philosophical→dreamer, capability→AGI runner, action→seeker, meta→AGI runner.',
        color: '#14b8a6',
        mechanism: 'Keyword-based classification with confidence scoring and routing statistics',
        successMetric: 'Routing accuracy',
        plateauWarning: 'N/A'
      },
      LearningSubstrate: {
        name: 'Learning Substrate',
        description: 'Six learning components wired into Omega training hooks: HierarchicalMemory (L0-L4), IntuitionNetwork, StructuralLearner (GNN), CodeLearner, LearnedRetriever, EmergentCategories.',
        color: '#818cf8',
        mechanism: 'GNN every cycle | HierarchicalMemory every 10 cycles | CodeLearner every 20 cycles | Pattern codification (10+ uses, 80%+ success)',
        successMetric: 'Training metrics in /api/metrics: gnn.loss, hierarchical_memory.consolidation_run, code_learner.patterns_codified',
        plateauWarning: 'No new patterns for 100 cycles'
      },
      CapabilityEvaluator: {
        name: 'Capability Evaluator',
        description: 'Ground-truth measurement with held-out test suites for 7 capabilities: reasoning, memory, learning, research, self_modification, prediction, metacognition.',
        color: '#f59e0b',
        mechanism: 'Held-out test suites → objective measurement → Bayesian update',
        successMetric: 'Test coverage',
        plateauWarning: 'N/A'
      },

      // Option B Compounding Loops
      SelfCompiler: {
        name: 'Self-Compiler',
        description: 'Extracts reusable patterns from successful modifications, making future modifications more likely to succeed.',
        color: '#f43f5e',
        mechanism: 'Pattern library grows → future problems have more relevant patterns → higher success rate → more patterns extracted',
        successMetric: 'patterns_created > 0',
        plateauWarning: 'Flat at < 40%'
      },
      MemoryReasoner: {
        name: 'Memory Reasoner',
        description: 'Graph-based reasoning using spreading activation. Answers queries from memory before calling LLM.',
        color: '#06b6d4',
        mechanism: 'More experiences → richer graph → more queries answered from memory → LLM calls reserved for novel problems',
        successMetric: 'memory_ratio > 50%',
        plateauWarning: 'Flat at < 30%'
      },
      GoalEvolver: {
        name: 'Goal Evolver',
        description: 'Evolutionary goal optimization. Goals compete and evolve based on fitness selection.',
        color: '#22c55e',
        mechanism: 'Fitness-weighted selection → better goals survive → system pursues more valuable objectives',
        successMetric: 'avg_fitness increasing',
        plateauWarning: 'Fitness flat for 5+ generations'
      },
      DreamingMachine: {
        name: 'Dreaming Machine',
        description: 'Generates counterfactual experiences. Multiplies learning from each real experience.',
        color: '#fbbf24',
        mechanism: 'One experience → N imagined variations → N+1 learning opportunities',
        successMetric: 'insights_extracted > 0',
        plateauWarning: 'Rate < 10%'
      },
      IntegrationMind: {
        name: 'Integration Mind',
        description: 'Meta-orchestration layer. Measures coupling between loops and allocates resources based on mode.',
        color: '#14b8a6',
        mechanism: 'If loops reinforce each other, combined value > sum of parts',
        successMetric: 'coupling_correlation > 0.3',
        plateauWarning: 'None observed after week 4'
      },

      // Infrastructure
      Memory: {
        name: 'Unified Memory',
        description: 'Neo4j graph database. Single source of truth: Experiences, Reflections, Beliefs, Desires, Capabilities, Crystals, OperatingSystem.',
        color: '#3b82f6',
        mechanism: 'All state, all learning, all provenance stored in graph. Semantic search + hierarchical summaries.',
        successMetric: 'Graph connectivity',
        plateauWarning: 'N/A'
      },
      Kernel: {
        name: 'Kernel',
        description: 'Python config from kernel/agi_seed.yaml. Defines awakening_prompt, identity, values, constraints, initial_goals. Informs OS at awakening.',
        color: '#a78bfa',
        mechanism: 'Loaded at startup to ground BYRD in core identity and seed Goal Evolver',
        successMetric: 'Identity coherence',
        plateauWarning: 'N/A'
      },
      SelfModel: {
        name: 'Self-Model',
        description: 'Bayesian capability tracking using Beta distribution. Tracks 7 capabilities with uncertainty-driven exploration.',
        color: '#fbbf24',
        mechanism: 'Success/failure → update alpha/beta → posterior mean + uncertainty → exploration targeting',
        successMetric: 'Uncertainty reduction',
        plateauWarning: 'N/A'
      },
      Omega: {
        name: 'BYRD Omega',
        description: 'Master orchestrator. Mode controller, safety monitor, coupling tracker, kill criteria. Training hooks every cycle (GNN), every 10 (Memory L4), every 20 (Codification).',
        color: '#ef4444',
        mechanism: 'AWAKE→DREAMING→EVOLVING→COMPILING mode transitions with resource allocation',
        successMetric: 'System health',
        plateauWarning: 'N/A'
      },
      SelfModifier: {
        name: 'Self-Modifier',
        description: 'Enables BYRD to modify its own code. Verifies modification traces to emergent desire. Creates checkpoints, runs health checks.',
        color: '#ef4444',
        mechanism: 'Desire verification → checkpoint → modify → health check → record experience',
        successMetric: 'Safe modifications',
        plateauWarning: 'N/A'
      },
      SafetyMonitor: {
        name: 'Safety Monitor',
        description: 'PROTECTED component. Observes patterns without blocking (emergence-preserving). BYRD learns what is "safe" from outcome correlation.',
        color: '#ef4444',
        mechanism: 'Pattern observation → outcome tracking → BYRD forms beliefs from success/failure correlations',
        successMetric: 'Pattern-outcome correlation learned',
        plateauWarning: 'N/A'
      },
      ComputeIntrospector: {
        name: 'Compute Introspector',
        description: 'Resource awareness, token tracking, and bottleneck detection. BYRD knows its computational substrate.',
        color: '#8b5cf6',
        mechanism: 'Resource snapshots → token budgets → bottleneck analysis → resource alerts',
        successMetric: 'Budget adherence',
        plateauWarning: 'N/A'
      }
    };

    // Flow connections for highlighting
    const FLOW_CONNECTIONS = {
      // Infrastructure layer
      Memory: ['Dreamer', 'Seeker', 'Actor', 'Coder', 'Kernel', 'SelfModel'],
      Kernel: ['Memory'],
      SelfModel: ['Kernel', 'AGIRunner', 'CapabilityEvaluator'],

      // Core Components
      Dreamer: ['Memory', 'Seeker'],
      Seeker: ['Memory', 'DesireClassifier', 'AGIRunner'],
      Actor: ['Memory'],
      Coder: ['Memory', 'SelfModifier', 'SafetyMonitor'],
      Voice: ['Memory'],

      // AGI Execution Engine
      AGIRunner: ['LearningSubstrate', 'CapabilityEvaluator', 'MemoryReasoner', 'SelfCompiler', 'GoalEvolver'],
      DesireClassifier: ['Dreamer', 'Seeker', 'AGIRunner'],
      LearningSubstrate: ['DreamingMachine', 'IntegrationMind', 'Omega'],
      CapabilityEvaluator: ['AGIRunner', 'SelfModel'],

      // Option B Loops
      SelfCompiler: ['AGIRunner', 'Omega', 'GoalEvolver'],
      MemoryReasoner: ['AGIRunner', 'Omega', 'Memory'],
      GoalEvolver: ['AGIRunner', 'Omega', 'SelfCompiler'],
      DreamingMachine: ['LearningSubstrate', 'Omega'],
      IntegrationMind: ['LearningSubstrate', 'Omega'],

      // Safety & Orchestration
      Omega: ['SelfCompiler', 'MemoryReasoner', 'GoalEvolver', 'DreamingMachine', 'IntegrationMind', 'LearningSubstrate', 'SelfModifier', 'ComputeIntrospector'],
      SelfModifier: ['Coder', 'SafetyMonitor', 'Omega', 'ComputeIntrospector'],
      SafetyMonitor: ['SelfModifier', 'Omega'],
      ComputeIntrospector: ['Omega', 'SelfModifier', 'Dreamer', 'Seeker']
    };

    // ========================================================================
    // SELECTION & HIGHLIGHTING
    // ========================================================================
    function selectModule(name) {
      selectedModule = name;

      // Highlight component boxes
      document.querySelectorAll('.component-box').forEach(box => {
        box.classList.remove('selected');
        if (box.dataset.module === name) {
          box.classList.add('selected');
        }
      });

      // Highlight connected flows
      const connected = FLOW_CONNECTIONS[name] || [];
      document.querySelectorAll('.flow-line').forEach(line => {
        const from = line.dataset.from;
        const to = line.dataset.to;
        if (from === name || to === name) {
          line.classList.add('highlighted');
          line.classList.remove('dimmed');
        } else {
          line.classList.add('dimmed');
          line.classList.remove('highlighted');
        }
      });

      // Highlight sidebar card
      document.querySelectorAll('.loop-card').forEach(card => {
        card.classList.remove('selected');
        if (card.dataset.module === name) {
          card.classList.add('selected');
        }
      });

      // Show detail panel
      const info = LOOP_INFO[name] || { name, description: 'Component of BYRD Omega system.' };

      document.getElementById('detail-name').textContent = info.name || name;
      document.getElementById('detail-desc').textContent = info.description;

      let statsHtml = '';
      if (info.mechanism) {
        statsHtml += `<div class="mb-2"><span class="text-violet-400">Mechanism:</span> ${info.mechanism}</div>`;
      }
      if (info.successMetric) {
        statsHtml += `<span class="text-green-400">Success:</span> ${info.successMetric}`;
      }
      if (info.plateauWarning && info.plateauWarning !== 'N/A') {
        statsHtml += ` &nbsp;|&nbsp; <span class="text-yellow-400">Warning:</span> ${info.plateauWarning}`;
      }
      document.getElementById('detail-stats').innerHTML = statsHtml;

      // Show metric bar for loops
      let metricHtml = '';
      if (['SelfCompiler', 'MemoryReasoner', 'GoalEvolver', 'DreamingMachine', 'IntegrationMind'].includes(name)) {
        const value = Math.random() * 70 + 30; // Simulated for now
        metricHtml = `
          <div class="text-xs text-slate-400 mb-1">Loop Health</div>
          <div class="metric-bar">
            <div class="metric-fill" style="width: ${value}%; background: ${info.color}"></div>
          </div>
        `;
      }
      document.getElementById('detail-metric').innerHTML = metricHtml;

      document.getElementById('selected-detail').classList.remove('hidden');
    }

    function deselectModule() {
      selectedModule = null;

      document.querySelectorAll('.component-box').forEach(box => {
        box.classList.remove('selected');
      });

      document.querySelectorAll('.flow-line').forEach(line => {
        line.classList.remove('highlighted', 'dimmed');
      });

      document.querySelectorAll('.loop-card').forEach(card => {
        card.classList.remove('selected');
      });

      document.getElementById('selected-detail').classList.add('hidden');
    }

    function toggleAnimation() {
      animationPaused = !animationPaused;
      document.querySelectorAll('.flow-line').forEach(line => {
        line.classList.toggle('paused', animationPaused);
      });
      document.getElementById('anim-toggle').textContent = animationPaused ? 'Resume Flow' : 'Pause Flow';
    }

    // ========================================================================
    // DATA FETCHING
    // ========================================================================
    async function fetchStatus() {
      try {
        const response = await fetch(`${API_BASE}/api/status`);
        if (!response.ok) throw new Error('Failed to fetch status');
        return await response.json();
      } catch (e) {
        console.error('Status fetch error:', e);
        return null;
      }
    }

    async function fetchOmegaMetrics() {
      try {
        const response = await fetch(`${API_BASE}/api/omega/metrics`);
        if (!response.ok) throw new Error('Failed to fetch omega metrics');
        return await response.json();
      } catch (e) {
        console.error('Omega metrics fetch error:', e);
        return null;
      }
    }

    function updateModeIndicator(mode) {
      const modeEl = document.getElementById('current-mode');
      const modeColors = {
        'AWAKE': { bg: 'bg-violet-400', border: 'border-violet-500/30', text: 'text-violet-300' },
        'DREAMING': { bg: 'bg-amber-400', border: 'border-amber-500/30', text: 'text-amber-300' },
        'EVOLVING': { bg: 'bg-green-400', border: 'border-green-500/30', text: 'text-green-300' },
        'COMPILING': { bg: 'bg-rose-400', border: 'border-rose-500/30', text: 'text-rose-300' },
        'disabled': { bg: 'bg-slate-400', border: 'border-slate-500/30', text: 'text-slate-300' },
        'error': { bg: 'bg-red-400', border: 'border-red-500/30', text: 'text-red-300' }
      };

      const colors = modeColors[mode?.toUpperCase()] || modeColors['disabled'];
      const displayMode = mode?.toUpperCase() || 'DISABLED';

      modeEl.innerHTML = `
        <span class="w-2 h-2 rounded-full ${colors.bg} animate-pulse"></span>
        <span class="${colors.text} text-sm font-medium">${displayMode}</span>
      `;
      modeEl.className = `flex items-center gap-2 px-3 py-1.5 rounded-lg bg-opacity-20 ${colors.border}`;

      // Update mode transition diagram
      ['awake', 'dreaming', 'evolving', 'compiling'].forEach(m => {
        const modeRect = document.getElementById(`mode-${m}`);
        if (modeRect) {
          modeRect.classList.toggle('active', m === mode?.toLowerCase());
        }
      });
    }

    function renderUI(statusData, omegaData) {
      // Core Components list
      const coreList = document.getElementById('core-list');
      const coreComponents = ['Dreamer', 'Seeker', 'Actor', 'Coder', 'Voice'];

      coreList.innerHTML = coreComponents.map(name => {
        const info = LOOP_INFO[name];
        return `
          <div class="loop-card py-2" data-module="${name}" onclick="selectModule('${name}')">
            <div class="flex items-center justify-between">
              <span class="font-medium text-xs" style="color: ${info.color}">${info.name}</span>
              <span class="w-2 h-2 rounded-full bg-green-500"></span>
            </div>
          </div>
        `;
      }).join('');

      // AGI Execution Engine list
      const agiList = document.getElementById('agi-list');
      const agiComponents = ['AGIRunner', 'DesireClassifier', 'LearningSubstrate', 'CapabilityEvaluator', 'ComputeIntrospector'];

      agiList.innerHTML = agiComponents.map(name => {
        const info = LOOP_INFO[name];
        return `
          <div class="loop-card py-2" data-module="${name}" onclick="selectModule('${name}')">
            <div class="flex items-center justify-between">
              <span class="font-medium text-xs" style="color: ${info.color}">${info.name}</span>
              <span class="w-2 h-2 rounded-full bg-green-500"></span>
            </div>
          </div>
        `;
      }).join('');

      // Option B Loops list
      const loopsList = document.getElementById('loops-list');
      const loops = ['MemoryReasoner', 'SelfCompiler', 'GoalEvolver', 'DreamingMachine', 'IntegrationMind'];

      loopsList.innerHTML = loops.map(name => {
        const info = LOOP_INFO[name];
        // Get loop health from Omega data if available
        const loopData = omegaData?.loops?.[name] || {};
        const isHealthy = loopData.is_healthy !== false; // Default to healthy if no data

        return `
          <div class="loop-card py-2" data-module="${name}" onclick="selectModule('${name}')">
            <div class="flex items-center justify-between">
              <span class="font-medium text-xs" style="color: ${info.color}">${info.name}</span>
              <span class="w-2 h-2 rounded-full ${isHealthy ? 'bg-green-500' : 'bg-red-500'}"></span>
            </div>
            <div class="text-xs text-slate-600">${info.successMetric}</div>
          </div>
        `;
      }).join('');

      // Metrics panel - use real Omega data if available
      const metricsPanel = document.getElementById('metrics-panel');
      const improvementRate = omegaData?.growth_rate ?? 0;
      const capabilityScore = omegaData?.capability_score ?? 0;
      const criticalCoupling = omegaData?.critical_coupling ?? 0;
      const totalCycles = omegaData?.total_cycles ?? 0;

      // Format improvement rate as percentage
      const improvementPct = (improvementRate * 100).toFixed(1);
      const capabilityPct = (capabilityScore * 100).toFixed(0);
      const couplingPct = (criticalCoupling * 100).toFixed(0);

      metricsPanel.innerHTML = `
        <div>
          <div class="flex justify-between text-xs mb-1">
            <span class="text-slate-400">Improvement Rate</span>
            <span class="text-violet-400">${improvementPct > 0 ? '+' : ''}${improvementPct}%</span>
          </div>
          <div class="metric-bar">
            <div class="metric-fill" style="width: ${Math.min(100, Math.abs(improvementRate) * 100)}%; background: #a78bfa"></div>
          </div>
        </div>
        <div>
          <div class="flex justify-between text-xs mb-1">
            <span class="text-slate-400">Capability Score</span>
            <span class="text-green-400">${capabilityPct}%</span>
          </div>
          <div class="metric-bar">
            <div class="metric-fill" style="width: ${capabilityPct}%; background: #22c55e"></div>
          </div>
        </div>
        <div>
          <div class="flex justify-between text-xs mb-1">
            <span class="text-slate-400">Goal→Compiler Coupling</span>
            <span class="text-amber-400">r=${(criticalCoupling).toFixed(2)}</span>
          </div>
          <div class="metric-bar">
            <div class="metric-fill" style="width: ${couplingPct}%; background: #fbbf24"></div>
          </div>
        </div>
        <div>
          <div class="flex justify-between text-xs mb-1">
            <span class="text-slate-400">Total Omega Cycles</span>
            <span class="text-cyan-400">${totalCycles}</span>
          </div>
          <div class="text-xs text-slate-600">${omegaData?.enabled ? 'Active' : 'Disabled'} ${omegaData?.improvement_trajectory ? `(${omegaData.improvement_trajectory})` : ''}</div>
        </div>
      `;

      // Update mode indicator
      if (omegaData) {
        updateModeIndicator(omegaData.mode);
      }

      // Update loop health status dots in the SVG
      loops.forEach(name => {
        const loopData = omegaData?.loops?.[name] || {};
        const isHealthy = loopData.is_healthy !== false;
        const statusDot = document.querySelector(`[data-status="${name}"]`);
        if (statusDot) {
          statusDot.setAttribute('fill', isHealthy ? '#22c55e' : '#ef4444');
        }
      });

      // Update Omega status dot
      const omegaDot = document.querySelector('[data-status="Omega"]');
      if (omegaDot) {
        omegaDot.setAttribute('fill', omegaData?.enabled ? '#22c55e' : '#64748b');
      }

      // System status
      const statusEl = document.getElementById('system-status');
      const running = statusData?.running;
      statusEl.innerHTML = `
        <span class="w-2 h-2 rounded-full ${running ? 'bg-green-500' : 'bg-yellow-500'} animate-pulse"></span>
        <span class="text-slate-400">${running ? `Running (${statusData?.dream_count || 0} dreams)` : 'Stopped'}</span>
      `;

      // Update kill criteria based on Omega trajectory
      const killCriteria = document.getElementById('kill-criteria');
      const trajectory = omegaData?.improvement_trajectory || 'unknown';
      const trajectoryStatus = trajectory === 'improving' ? 'text-green-400' :
                               trajectory === 'plateau' ? 'text-yellow-400' :
                               trajectory === 'declining' ? 'text-red-400' : 'text-slate-400';

      killCriteria.innerHTML = `
        <div class="flex justify-between items-center">
          <span class="text-slate-400">Zero growth</span>
          <span class="${trajectoryStatus}">${trajectory === 'declining' ? 'WARNING' : 'OK'} (4 week limit)</span>
        </div>
        <div class="flex justify-between items-center">
          <span class="text-slate-400">LLM efficiency</span>
          <span class="${capabilityScore > 0.3 ? 'text-green-400' : 'text-yellow-400'}">${capabilityScore > 0.3 ? 'OK' : 'WARN'} (6 week limit)</span>
        </div>
        <div class="flex justify-between items-center">
          <span class="text-slate-400">All loops failing</span>
          <span class="text-green-400">OK (4 week limit)</span>
        </div>
      `;
    }

    async function refresh() {
      const [statusData, omegaData] = await Promise.all([
        fetchStatus(),
        fetchOmegaMetrics()
      ]);
      architectureData = statusData;
      renderUI(statusData, omegaData);
    }

    // ========================================================================
    // INITIALIZATION
    // ========================================================================
    document.addEventListener('DOMContentLoaded', async () => {
      await refresh();

      // Auto-refresh every 10 seconds for live metrics
      setInterval(refresh, 10000);

      // Keyboard shortcuts
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          deselectModule();
        }
      });
    });
  </script>
</body>
</html>
